{"version":3,"sources":["controls/iFrameDialog/IFrameDialog.tsx"],"names":[],"mappings":"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","file":"controls/iFrameDialog/IFrameDialog.js","sourcesContent":["import * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\nimport { Dialog, IDialogProps } from 'office-ui-fabric-react/lib/Dialog';\r\nimport { IFrameDialogContent } from './IFrameDialogContent';\r\nimport * as telemetry from '../../common/telemetry';\r\nimport { Guid } from \"@microsoft/sp-core-library\";\r\nimport omit = require('lodash/omit');\r\n\r\nexport interface IFrameDialogProps extends IDialogProps {\r\n  /**\r\n   * iframe Url\r\n   */\r\n  url: string;\r\n  /**\r\n   * iframe's onload event handler\r\n   */\r\n  iframeOnLoad?: (iframe: any) => void;\r\n  /**\r\n   * iframe width\r\n   */\r\n  width: string;\r\n  /**\r\n   * iframe height\r\n   */\r\n  height: string;\r\n  /**\r\n   * Specifies if iframe content can be displayed in a full screen.\r\n   * Usage: <IFrameDialog allowFullScreen />\r\n   */\r\n  allowFullScreen?: boolean;\r\n  /**\r\n   * Specifies if transparency is allowed in iframe\r\n   */\r\n  allowTransparency?: boolean;\r\n  /**\r\n   * Specifies the top and bottom margins of the content of an <iframe>\r\n   */\r\n  marginHeight?: number;\r\n  /**\r\n   * Specifies the left and right margins of the content of an <iframe>\r\n   */\r\n  marginWidth?: number;\r\n  /**\r\n   * Specifies the name of an <iframe>\r\n   */\r\n  name?: string;\r\n  /**\r\n   * Enables an extra set of restrictions for the content in an <iframe>\r\n   */\r\n  sandbox?: string;\r\n  /**\r\n   * Specifies whether or not to display scrollbars in an <iframe>\r\n   */\r\n  scrolling?: string;\r\n  /**\r\n   * When present, it specifies that the <iframe> should look like it is a part of the containing document (no borders or scrollbars)\r\n   */\r\n  seamless?: boolean;\r\n}\r\n\r\nexport interface IFrameDialogState {\r\n  dialogId: string | null;\r\n  isStylingSet?: boolean;\r\n}\r\n\r\n/**\r\n * Dialog component to display content in iframe\r\n */\r\nexport class IFrameDialog extends React.Component<IFrameDialogProps, IFrameDialogState> {\r\n\r\n  public constructor(props: IFrameDialogProps, state: IFrameDialogState) {\r\n    super(props, state);\r\n\r\n    telemetry.track('IFrameDialog', {});\r\n\r\n    this.state = {\r\n      dialogId: null\r\n    };\r\n  }\r\n\r\n  /**\r\n   * componentWillMount lifecycle hook\r\n   */\r\n  public componentWillMount(): void {\r\n    this.setState({\r\n      dialogId: `dialog-${Guid.newGuid().toString()}`\r\n    });\r\n  }\r\n\r\n  /**\r\n   * componentDidMount lifecycle hook\r\n   */\r\n  public componentDidMount(): void {\r\n    this.setDialogStyling();\r\n  }\r\n\r\n  public componentDidUpdate(prevProps: IFrameDialogProps, prevState: IFrameDialogState): void {\r\n    this.setDialogStyling();\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const {\r\n      iframeOnLoad,\r\n      height,\r\n      allowFullScreen,\r\n      allowTransparency,\r\n      marginHeight,\r\n      marginWidth,\r\n      name,\r\n      sandbox,\r\n      scrolling,\r\n      seamless,\r\n      modalProps,\r\n      className\r\n    } = this.props;\r\n\r\n    let dlgModalProps = {\r\n      ...modalProps,\r\n      onLayerDidMount: () => { this.setDialogStyling(); }\r\n    };\r\n\r\n    return (\r\n      <Dialog\r\n        className={`${this.state.dialogId} ${className || ''}`}\r\n        modalProps={dlgModalProps}\r\n        {...omit(this.props, 'className', 'modalProps')}>\r\n        <IFrameDialogContent src={this.props.url}\r\n          iframeOnLoad={iframeOnLoad}\r\n          close={this.props.onDismiss}\r\n          height={height}\r\n          allowFullScreen={allowFullScreen}\r\n          allowTransparency={allowTransparency}\r\n          marginHeight={marginHeight}\r\n          marginWidth={marginWidth}\r\n          name={name}\r\n          sandbox={sandbox}\r\n          scrolling={scrolling}\r\n          seamless={seamless}\r\n        />\r\n      </Dialog>);\r\n  }\r\n\r\n  /**\r\n   * Set the dialog style\r\n   */\r\n  private setDialogStyling(): void {\r\n    if (!this.state.isStylingSet && !this.props.hidden && this.state.dialogId) {\r\n      const element = document.querySelector(`.${this.state.dialogId} .ms-Dialog-main`) as HTMLElement;\r\n      const {\r\n        width\r\n      } = this.props;\r\n      if (element && width) {\r\n        element.style.width = width;\r\n        element.style.minWidth = width;\r\n        element.style.maxWidth = width;\r\n\r\n        this.setState({\r\n          isStylingSet: true\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}