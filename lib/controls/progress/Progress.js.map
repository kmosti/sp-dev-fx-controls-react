{"version":3,"sources":["controls/progress/Progress.tsx"],"names":[],"mappings":"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","file":"controls/progress/Progress.js","sourcesContent":["import * as React from 'react';\r\nimport { IProgressProps, IProgressAction, ProgressActionState, IProgressState } from './IProgress';\r\nimport { Action } from './Action';\r\nimport { ProgressIndicator } from 'office-ui-fabric-react/lib/ProgressIndicator';\r\nimport styles from './Progress.module.scss';\r\nimport * as telemetry from \"../../common/telemetry\";\r\n\r\n/**\r\n* Component to show progress of multiple SEQUENTIALLY executed actions\r\n*/\r\nexport class Progress extends React.Component<IProgressProps, IProgressState> {\r\n\r\n  constructor(props: IProgressProps) {\r\n    super(props);\r\n\r\n    telemetry.track('ReactProgress', {});\r\n\r\n    this.state = {\r\n      showLongRunningText: props.longRunningText && !props.longRunningTextDisplayDelay\r\n    };\r\n  }\r\n\r\n  /**\r\n   * componentDidUpdate lifecycle hook\r\n   */\r\n  public componentDidUpdate() {\r\n    // Check if we need to start a timer to display long running text\r\n    if (this.props.longRunningText && this.props.longRunningTextDisplayDelay && this.props.currentActionIndex === 0) {\r\n      setTimeout(() => {\r\n        this.setState({\r\n          showLongRunningText: true\r\n        });\r\n      }, this.props.longRunningTextDisplayDelay);\r\n    }\r\n\r\n    // long running text should be hidden if all the actions have been executed\r\n    if (this.state.showLongRunningText && this.props.currentActionIndex >= this.props.actions.length) {\r\n      this.setState({\r\n        showLongRunningText: false\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * shouldComponentUpdate lifecycle hook\r\n   *\r\n   * @param nextProps\r\n   */\r\n  public shouldComponentUpdate(nextProps: IProgressProps): boolean {\r\n    if (this.props.currentActionIndex !== nextProps.currentActionIndex ||\r\n        this.props.showOverallProgress !== nextProps.showOverallProgress ||\r\n        this.props.title !== nextProps.title ||\r\n        !this._areActionsEqual(this.props.actions, nextProps.actions)) {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Default React render method\r\n   */\r\n  public render(): React.ReactElement<IProgressProps> {\r\n    const {\r\n      currentActionIndex,\r\n      showOverallProgress,\r\n      showIndeterminateOverallProgress,\r\n      hideNotStartedActions,\r\n      title,\r\n      actions,\r\n      height,\r\n      longRunningText,\r\n      className,\r\n      headerClassName,\r\n      actionClassName,\r\n      actionsContainerClassName,\r\n      successIconName,\r\n      errorIconName,\r\n      inProgressIconName\r\n    } = this.props;\r\n\r\n    // correcting action index if props contain incorrect one\r\n    let actionIndex = currentActionIndex;\r\n    if (actionIndex > actions.length) {\r\n      actionIndex = actions.length;\r\n    }\r\n\r\n    // getting actions to be rendered based on hideNotStartedActions flag\r\n    const actionsToRender: IProgressAction[] = hideNotStartedActions ? actions.filter((a, index) => {\r\n      return index <= currentActionIndex;\r\n    }) : actions;\r\n\r\n    const actionEls: JSX.Element[] = actionsToRender.map((a, index) => {\r\n      let state = ProgressActionState.notStarted; // by default the state is not started\r\n\r\n      if (a.hasError && index <= actionIndex) { // current or prev action has errored\r\n        state = ProgressActionState.errored;\r\n      } else if (actionIndex === index) { // current action is in progress\r\n        state = ProgressActionState.inProgress;\r\n      } else if (index < actionIndex) { // finished with no errors\r\n        state = ProgressActionState.finished;\r\n      }\r\n\r\n      return <Action {...a}\r\n                     state={state}\r\n                     key={index}\r\n                     className={actionClassName}\r\n                     successIconName={successIconName}\r\n                     errorIconName={errorIconName}\r\n                     inProgressIconName={inProgressIconName} />;\r\n    });\r\n\r\n    // calculating progress and progressSubText based on parameters\r\n    let progress: number | null = 0;\r\n    let progressSubTtext = '';\r\n\r\n    if (showIndeterminateOverallProgress) {\r\n      if (actionIndex || actionIndex < actions.length) {\r\n        progress = null;\r\n        progressSubTtext = `${(actionIndex / actions.length * 100).toFixed(0)}%`;\r\n      }\r\n    } else {\r\n      progress = actionIndex ? actionIndex / actions.length : 0;\r\n      progressSubTtext = actionIndex ? `${(progress * 100).toFixed(0)}%` : '';\r\n    }\r\n\r\n    //   header is displayed if title, showOverallProgress, or showLongRunnungText are set\r\n    //   progress indicator is shown if showOverallProgress is set to true\r\n    //   progress indicator subtext is shown if showOverallProgress is set to true and there is a text to display (see if section above)\r\n    //   long running text is shown if there is a text and we waited needed delay time\r\n    return (\r\n      <div className={`${styles.progress} ${className || \"\"}`} style={{ height: height || 'auto' }}>\r\n        {\r\n          (title || showOverallProgress || this.state.showLongRunningText) && (\r\n            <div className={`${styles.header} ${headerClassName || \"\"}`}>\r\n              <div className={styles.title}>{title}</div>\r\n\r\n              {\r\n                showOverallProgress && (\r\n                  <div className={styles.progressIndicator}>\r\n                    <ProgressIndicator percentComplete={progress} />\r\n                  </div>\r\n                )\r\n              }\r\n\r\n              {\r\n                (showOverallProgress && progressSubTtext) && <span className={styles.progressSubtext}>{progressSubTtext}</span>\r\n              }\r\n\r\n              {\r\n                this.state.showLongRunningText && <div className={styles.longRunningText}>{longRunningText}</div>\r\n              }\r\n            </div>\r\n          )\r\n        }\r\n\r\n        <div className={`${styles.actionsContainer} ${actionsContainerClassName || \"\"}`}>\r\n          {actionEls}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _areActionsEqual(actions: IProgressAction[], nextActions: IProgressAction[]): boolean {\r\n    if (actions.length !== nextActions.length) {\r\n      return false;\r\n    }\r\n\r\n    for (let i = 0, len = actions.length; i < len; i++) {\r\n      const action = actions[i];\r\n      const nextAction = nextActions[i];\r\n\r\n      // comparing error state only,\r\n      // assuming that actions can't be changed during the progress execution\r\n      if (action.hasError !== nextAction.hasError) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}