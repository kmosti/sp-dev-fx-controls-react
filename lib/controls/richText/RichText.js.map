{"version":3,"sources":["controls/richText/RichText.tsx"],"names":[],"mappings":";;;;;;;;;;;;AAAA,6BAA+B;AAC/B,wCAA0C;AAC1C,2CAAyC;AACzC,+DAA0D;AAC1D,2CAAgD;AAChD,+DAA4C;AAE5C,4DAA+D;AAC/D,8DAAkD;AAClD,8DAAiE;AACjE,4DAAqF;AACrF,kEAAiE;AACjE,wDAAuD;AACvD,4DAAiF;AACjF,gEAAgF;AAChF,wDAAuD;AACvD,kEAAuE;AACvE,kDAAoD;AACpD,0DAAmE;AACnE,wCAA2C;AAG3C,IAAM,cAAc,GAAW,EAAE,CAAC;AAClC;;;;;;;GAOG;AAEH,uBAAe,EAAE,CAAC;AAElB;IAA8B,4BAA+C;IAyE3E,kBAAY,KAAqB;QAAjC,YACE,kBAAM,KAAK,CAAC,SAoBb;QA7FO,gBAAU,GAAe,SAAS,CAAC;QACnC,iBAAW,GAAmB,SAAS,CAAC;QACxC,sBAAgB,GAAyB,SAAS,CAAC;QACnD,gBAAU,GAAG,SAAS,CAAC;QAEvB,iBAAW,GAAG,CAAC;gBACrB,GAAG,EAAE,CAAC;gBACN,IAAI,EAAE,OAAO,CAAC,gBAAgB;gBAC9B,IAAI,EAAE,EAAG;aACV,EAAE;gBACD,GAAG,EAAE,CAAC;gBACN,IAAI,EAAE,OAAO,CAAC,QAAQ;gBACtB,IAAI,EACF,EAAE,SAAS,EAAE,8BAAM,CAAC,eAAe,EAAE;aACxC,EAAE;gBACD,GAAG,EAAE,CAAC;gBACN,IAAI,EAAE,OAAO,CAAC,QAAQ;gBACtB,IAAI,EACF,EAAE,SAAS,EAAE,8BAAM,CAAC,eAAe,EAAE;aACxC,EAAE;gBACD,GAAG,EAAE,CAAC;gBACN,IAAI,EAAE,OAAO,CAAC,QAAQ;gBACtB,IAAI,EACF,EAAE,SAAS,EAAE,8BAAM,CAAC,eAAe,EAAE;aACxC,EAAE;gBACD,GAAG,EAAE,CAAC;gBACN,IAAI,EAAE,OAAO,CAAC,gBAAgB;gBAC9B,IAAI,EACF,EAAE,SAAS,EAAE,8BAAM,CAAC,uBAAuB,EAAE;aAChD,CAAC,CAAC;QAEK,iBAAW,GAAG,CAAC;gBACrB,GAAG,EAAE,MAAM;gBACX,IAAI,EAAE,OAAO,CAAC,SAAS;gBACvB,IAAI,EAAE,EAAE,IAAI,EAAE,WAAW,EAAE;aAC5B,EAAE;gBACD,GAAG,EAAE,QAAQ;gBACb,IAAI,EAAE,OAAO,CAAC,WAAW;gBACzB,IAAI,EAAE,EAAE,IAAI,EAAE,aAAa,EAAE;aAC9B,EAAE;gBACD,GAAG,EAAE,OAAO;gBACZ,IAAI,EAAE,OAAO,CAAC,UAAU;gBACxB,IAAI,EAAE,EAAE,IAAI,EAAE,YAAY,EAAE;aAC7B,CAAC,CAAC;QAEK,gBAAU,GAAG,CAAC;gBACpB,GAAG,EAAE,QAAQ;gBACb,IAAI,EAAE,OAAO,CAAC,UAAU;gBACxB,IAAI,EAAE,EAAE,IAAI,EAAE,cAAc,EAAE;aAC/B,EAAE;gBACD,GAAG,EAAE,SAAS;gBACd,IAAI,EAAE,OAAO,CAAC,YAAY;gBAC1B,IAAI,EAAE,EAAE,IAAI,EAAE,cAAc,EAAE;aAC/B,CAAC,CAAC;QA2GH;;WAEG;QACI,eAAS,GAAG;YACjB,IAAI,CAAC;gBACH,MAAM,CAAC,KAAI,CAAC,UAAW,CAAC,SAAS,EAAE,CAAC;YACtC,CAAC;YAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;gBACf,MAAM,CAAC,SAAS,CAAC;YACnB,CAAC;QACH,CAAC,CAAA;QA8ID;;WAEG;QACK,sBAAgB,GAAG;YACzB,MAAM,CAAC,CACL,oBAAC,eAAM,IAAC,MAAM,EAAE,KAAI,CAAC,KAAK,CAAC,UAAU,EAC7B,SAAS,EAAE,KAAI,CAAC,WAAW,EAC3B,kBAAkB,EAAE;oBAClB,IAAI,EAAE,mBAAU,CAAC,MAAM;oBACvB,KAAK,EAAE,OAAO,CAAC,eAAe;iBAC/B,EACD,UAAU,EAAE;oBACV,SAAS,EAAE,8BAAM,CAAC,gBAAgB;oBAClC,UAAU,EAAE,IAAI;oBAChB,kBAAkB,EAAE,uBAAuB;iBAC5C;gBACP,oBAAC,qBAAS,IAAC,KAAK,EAAE,OAAO,CAAC,iBAAiB,EAChC,KAAK,EAAE,KAAI,CAAC,KAAK,CAAC,SAAS,KAAK,SAAS,GAAG,KAAI,CAAC,KAAK,CAAC,SAAS,GAAG,UAAU,EAC7E,SAAS,EAAE,UAAC,QAAiB;wBAC5B,KAAI,CAAC,QAAQ,CAAC;4BACZ,SAAS,EAAE,QAAQ;yBACpB,CAAC,CAAC;oBACL,CAAC,GAAI;gBAEf,oBAAC,qBAAS,IAAC,KAAK,EAAE,OAAO,CAAC,kBAAkB,EACjC,KAAK,EAAE,KAAI,CAAC,KAAK,CAAC,aAAa,IAAI,KAAI,CAAC,KAAK,CAAC,SAAS,EACvD,SAAS,EAAE,UAAC,QAAiB;wBAC5B,EAAE,CAAC,CAAC,QAAQ,KAAK,KAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;4BACtC,KAAI,CAAC,QAAQ,CAAC;gCACZ,aAAa,EAAE,QAAQ;6BACxB,CAAC,CAAC;wBACL,CAAC;oBACF,CAAC,GAAI;gBAEhB,oBAAC,qBAAY,IAAC,SAAS,EAAE,8BAAM,CAAC,OAAO;oBACrC,6BAAK,SAAS,EAAE,4BAA0B,8BAAM,CAAC,YAAc;wBAE3D,KAAI,CAAC,KAAK,CAAC,WAAW,IAAI,CACxB,oBAAC,WAAI,IAAC,SAAS,EAAK,8BAAM,CAAC,MAAM,SAAI,8BAAM,CAAC,YAAc,EAAE,OAAO,EAAE,KAAI,CAAC,gBAAgB,IAAG,OAAO,CAAC,eAAe,CAAQ,CAC7H;wBAEH,oBAAC,sBAAa,IAAC,SAAS,EAAE,8BAAM,CAAC,MAAM,EAAE,OAAO,EAAE,KAAI,CAAC,gBAAgB,EAAE,IAAI,EAAE,OAAO,CAAC,eAAe,GAAI;wBAC1G,oBAAC,sBAAa,IAAC,SAAS,EAAE,8BAAM,CAAC,MAAM,EAAE,OAAO,EAAE,KAAI,CAAC,WAAW,EAAE,IAAI,EAAE,OAAO,CAAC,iBAAiB,GAAI,CACnG,CACO,CACR,CACV,CAAC;QACJ,CAAC,CAAA;QAqMD;;WAEG;QACK,kBAAY,GAAG;YACrB,IAAM,YAAY,GAAG,CAAC,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC;YAC9C,KAAI,CAAC,WAAW,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;QACzC,CAAC,CAAA;QAEO,oBAAc,GAAG;YACvB,IAAM,QAAQ,GAAG,CAAC,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC;YAC5C,KAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;QACvC,CAAC,CAAA;QAEO,uBAAiB,GAAG;YAC1B,IAAM,QAAQ,GAAG,CAAC,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC;YAC/C,KAAI,CAAC,WAAW,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;QAC1C,CAAC,CAAA;QACO,qBAAe,GAAG,UAAC,IAAqB;YAC9C,IAAM,eAAe,GAAG,IAAI,CAAC,GAAG,KAAK,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;YAClE,KAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,eAAe,CAAC,CAAC;QAC9C,CAAC,CAAA;QAEO,mBAAa,GAAG,UAAC,IAAqB;YAC5C,IAAM,aAAa,GAAG,IAAI,CAAC,GAAG,KAAK,MAAM,GAAG,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;YACxE,KAAI,CAAC,WAAW,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;QAC3C,CAAC,CAAA;QAEO,kBAAY,GAAG,UAAC,IAAqB;YAC3C,4CAA4C;YAC5C,IAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;YACrB,IAAM,aAAa,GAAG,CAAC,GAAG,KAAK,QAAQ,IAAI,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,KAAK,QAAQ,CAAC,IAAI,CAAC,GAAG,KAAK,UAAU,IAAI,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,KAAK,UAAU,CAAC,GAAG,KAAK,GAAG,GAAG,CAAC;YACjK,KAAI,CAAC,WAAW,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;QAC1C,CAAC,CAAA;QAED;;WAEG;QACK,0BAAoB,GAAG;YAC7B,IAAM,KAAK,GAAG,KAAI,CAAC,SAAS,EAAE,CAAC;YAC/B,IAAM,KAAK,GAAG,KAAK,CAAC,YAAY,EAAE,CAAC;YAEnC,IAAI,QAAQ,GAAG,KAAI,CAAC,KAAK,CAAC,YAAY,CAAC;YACvC,EAAE,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,WAAW,KAAK,SAAS,IAAI,KAAI,CAAC,KAAK,CAAC,YAAY,KAAK,EAAE,CAAC,CAAC,CAAC;gBACnE,IAAA,uBAAI,CAAgB;gBAC5B,IAAM,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,KAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;gBAC3D,IAAM,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,aAAa,CAAC,GAAG,CAAC,CAAC;gBAC5D,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC;gBACvD,IAAM,UAAU,GAAG,YAAY,GAAG,cAAc,CAAC;gBACjD,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,UAAU,CAAC,CAAC;gBAEnD,iDAAiD;gBACjD,IAAM,UAAU,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC;gBACnC,IAAM,SAAS,GAAG,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;gBAC/C,KAAK,CAAC,KAAK,GAAG,SAAS,CAAC;gBACxB,KAAK,CAAC,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC;YACjC,CAAC;YAED,KAAI,CAAC,QAAQ,CAAC;gBACZ,UAAU,EAAE,KAAK;gBACjB,aAAa,EAAE,QAAQ;gBACvB,SAAS,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW;gBACjC,aAAa,EAAE,KAAK;aACrB,CAAC,CAAC;QACL,CAAC,CAAA;QAED;;WAEG;QACK,iBAAW,GAAG;YACpB,KAAI,CAAC,QAAQ,CAAC,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC;QACtC,CAAC,CAAA;QAED;;WAEG;QACK,mBAAa,GAAG,UAAC,KAAK,EAAE,MAAM,EAAE,MAAM;YAC5C,EAAE,CAAC,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;gBACxB,KAAI,CAAC,QAAQ,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;YACnC,CAAC;QACH,CAAC,CAAA;QAED;;WAEG;QACK,sBAAgB,GAAG;YACzB,IAAM,KAAK,GAAG,KAAI,CAAC,SAAS,EAAE,CAAC;YAC/B,KAAK,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;YAC5B,KAAI,CAAC,WAAW,EAAE,CAAC;QACrB,CAAC,CAAA;QAED;;WAEG;QACK,sBAAgB,GAAG;YACzB,IAAM,KAAK,GAAG,KAAI,CAAC,SAAS,EAAE,CAAC;YAC/B,IAAM,KAAK,GAAG,KAAI,CAAC,KAAK,CAAC,aAAa,CAAC;YACvC,IAAM,cAAc,GAAW,KAAM,CAAC,KAAK,CAAC;YAC5C,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;gBACrB,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;YAC9C,CAAC;YAED,EAAE,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;gBACnB,IAAM,YAAY,GAAW,KAAI,CAAC,KAAK,CAAC,aAAa,KAAK,SAAS,GAAG,KAAI,CAAC,KAAK,CAAC,aAAa,GAAG,KAAI,CAAC,KAAK,CAAC,SAAS,CAAC;gBACtH,IAAM,WAAW,GAAW,KAAI,CAAC,KAAK,CAAC,SAAS,CAAC;gBACjD,KAAK,CAAC,UAAU,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC;gBAC/C,KAAK,CAAC,YAAY,CAAC,cAAc,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;gBACxD,KAAK,CAAC,UAAU,CAAC,cAAc,EAAE,YAAY,CAAC,MAAM,EAAE,MAAM,EAAE,WAAW,CAAC,CAAC;YAC7E,CAAC;YAED,KAAI,CAAC,QAAQ,CAAC;gBACZ,UAAU,EAAE,IAAI;gBAChB,SAAS,EAAE,SAAS;gBACpB,aAAa,EAAE,SAAS;aACzB,CAAC,CAAC;QACL,CAAC,CAAA;QAiBD;;WAEG;QACK,2BAAqB,GAAG,UAAC,KAAK,EAAE,QAAQ,EAAE,MAAM;YACtD,IAAM,KAAK,GAAG,KAAI,CAAC,SAAS,EAAE,CAAC;YAC/B,IAAI,CAAC;gBACH,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;oBACV,wBAAwB;oBACxB,IAAM,YAAY,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;oBAE1C,yBAAyB;oBACzB,IAAM,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;oBAEvC,iCAAiC;oBACjC,IAAM,WAAW,GAAG,OAAO,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,GAAG,SAAS,CAAC;oBAE5D,KAAI,CAAC,QAAQ,CAAC;wBACZ,YAAY,EAAE,YAAY;wBAC1B,WAAW,EAAE,WAAW;wBACxB,OAAO,EAAE,OAAO;qBACjB,CAAC,CAAC;oBAEH,EAAE,CAAC,CAAC,KAAI,CAAC,gBAAgB,IAAI,KAAI,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC;wBACxD,KAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,KAAK,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;oBACnE,CAAC;gBACH,CAAC;YACH,CAAC;YAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YAEjB,CAAC;QACH,CAAC,CAAA;QAED;;WAEG;QACK,sBAAgB,GAAG;YACzB,KAAI,CAAC,UAAU,EAAE,CAAC;QACpB,CAAC,CAAA;QAED;;WAEG;QACK,gBAAU,GAAG;YACnB,KAAI,CAAC,QAAQ,CAAC,EAAE,eAAe,EAAE,KAAK,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAA;QAED;;WAEG;QACK,oBAAc,GAAG;YACvB,KAAI,CAAC,QAAQ,CAAC;gBACZ,eAAe,EAAE,CAAC,KAAI,CAAC,KAAK,CAAC,eAAe;aAC7C,EAAE;gBACD,KAAI,CAAC,SAAS,EAAE,CAAC,KAAK,EAAE,CAAC;YAC3B,CAAC,CAAC,CAAC;QACL,CAAC,CAAA;QAED;;WAEG;QACK,kBAAY,GAAG,UAAC,KAAa;YAC3B,IAAA,+BAAQ,CAAgB;YAEhC,wCAAwC;YACxC,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACb,6CAA6C;gBAC7C,IAAI,OAAO,GAAW,QAAQ,CAAC,KAAK,CAAC,CAAC;gBACtC,KAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;YACnC,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,kCAAkC;gBAClC,KAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC;YACjC,CAAC;QACH,CAAC,CAAA;QAED;;WAEG;QACK,wBAAkB,GAAG,UAAC,KAAK;YACjC,IAAI,OAAO,GAAY,CAAC,2BAAe,CAAC,KAAI,CAAC,WAAW,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;YAExE,wBAAwB;YACxB,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;gBACZ,4CAA4C;gBAC5C,wDAAwD;gBACxD,EAAE,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;oBACvB,KAAI,CAAC,QAAQ,CAAC;wBACZ,OAAO,EAAE,KAAK;qBACf,CAAC,CAAC;gBACL,CAAC;YACH,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,oBAAoB;gBACpB,EAAE,CAAC,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;oBACxB,gDAAgD;oBAChD,KAAI,CAAC,QAAQ,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;gBACnC,CAAC;YACH,CAAC;QACH,CAAC,CAAA;QAED;;WAEG;QACK,eAAS,GAAG,UAAC,CAAM;YACzB,KAAI,CAAC,UAAU,GAAG,CAAC,CAAC;QACtB,CAAC,CAAA;QAED;;WAEG;QACK,sBAAgB,GAAG,UAAC,CAAM;YAChC,KAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;QAC5B,CAAC,CAAA;QAjtBC,SAAS,CAAC,KAAK,CAAC,eAAe,EAAE;YAC/B,SAAS,EAAE,CAAC,CAAC,KAAK,CAAC,SAAS;SAC7B,CAAC,CAAC;QAEH,KAAI,CAAC,KAAK,GAAG;YACX,IAAI,EAAE,KAAI,CAAC,KAAK,CAAC,KAAK;YACtB,OAAO,EAAE,KAAK;YACd,eAAe,EAAE,KAAK;YACtB,UAAU,EAAE,IAAI;YAChB,OAAO,EAAE,EAAE;YACX,SAAS,EAAE,SAAS;YACpB,aAAa,EAAE,SAAS;YACxB,YAAY,EAAE,SAAS;YACvB,WAAW,EAAE,SAAS;YACtB,UAAU,EAAE,CAAC;SACd,CAAC;QAEF,0BAA0B;QAC1B,KAAI,CAAC,UAAU,GAAG,UAAU,GAAG,sBAAI,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE,CAAC;;IAC3D,CAAC;IAED;;OAEG;IACI,oCAAiB,GAAxB;QACE,qDAAqD;QACrD,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC;YAC1B,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAC5D,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAE5D,IAAM,UAAU,GAAe,IAAI,CAAC,WAAW,CAAC,qBAAqB,EAAE,CAAC;YACxE,IAAM,gBAAgB,GAAe,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,qBAAqB,EAAE,CAAC;YAC5F,IAAM,UAAU,GAAW,UAAU,CAAC,GAAG,GAAG,gBAAgB,CAAC,GAAG,GAAG,cAAc,CAAC;YAElF,IAAI,CAAC,QAAQ,CAAC;gBACZ,UAAU,EAAE,UAAU;aACvB,CAAC,CAAC;QACL,CAAC;IACH,CAAC;IAED;;OAEG;IACI,uCAAoB,GAA3B;QACE,yDAAyD;QACzD,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC;YAC1B,QAAQ,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAC/D,QAAQ,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;QACjE,CAAC;IACH,CAAC;IAED;;;;;OAKG;IACI,qCAAkB,GAAzB,UAA0B,SAAyB,EAAE,SAAyB;QAC5E,4CAA4C;QAC5C,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC;YACnD,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAC5D,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;QAC9D,CAAC;QAED,iDAAiD;QACjD,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,IAAI,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC;YACnD,QAAQ,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAC/D,QAAQ,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;QACjE,CAAC;IACH,CAAC;IAED;;;;;OAKG;IACI,wCAAqB,GAA5B,UAA6B,SAAyB,EAAE,SAAyB;QAC/E,4CAA4C;QAC5C,EAAE,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YACnC,MAAM,CAAC,KAAK,CAAC;QACf,CAAC;QAED,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAaD;;;;OAIG;IACK,sCAAmB,GAA3B,UAA6B,MAAuB;QAClD,MAAM,CAAC,CACL,oBAAC,qBAAW,IAAC,OAAO,EAAE,MAAM,CAAC,IAAI,EACpB,EAAE,EAAK,MAAM,CAAC,IAAI,mBAAgB,EAClC,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;YACxC,6BAAK,SAAS,EAAK,8BAAM,CAAC,qBAAqB,UAAI,MAAM,CAAC,IAAK,CAAC,SAAS,GAAG,MAAM,CAAC,IAAK,CAAC,SAAS,GAAG,EAAE,CAAE,sBAC/E,MAAM,CAAC,IAAI,mBAAgB;gBACnD,kCAAO,MAAM,CAAC,IAAI,CAAQ,CACtB,CACM,CACf,CAAC;IACJ,CAAC;IAED;;;;OAIG;IACK,qCAAkB,GAA1B,UAA4B,OAA0B;QACpD,IAAM,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;QAE1B,MAAM,CAAC,CACL,oBAAC,qBAAW,IAAC,OAAO,EAAE,MAAM,CAAC,IAAI,EACpB,EAAE,EAAK,MAAM,CAAC,IAAI,mBAAgB,EAClC,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;YACxC,6BAAK,SAAS,EAAE,8BAAM,CAAC,2BAA2B,sBACxB,MAAM,CAAC,IAAI,mBAAgB;gBACnD,kCAAO,MAAM,CAAC,IAAI,CAAQ,CACtB,CACM,CACf,CAAC;IACJ,CAAC;IAED;;;;OAIG;IACK,sCAAmB,GAA3B,UAA6B,MAAuB;QAClD,MAAM,CAAC,CACL,oBAAC,qBAAW,IAAC,OAAO,EAAE,MAAM,CAAC,IAAI,EACpB,EAAE,EAAK,MAAM,CAAC,IAAI,mBAAgB,EAClC,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;YACxC,6BAAK,SAAS,EAAK,8BAAM,CAAC,qBAAqB,UAAI,MAAM,CAAC,IAAK,CAAC,SAAS,GAAG,MAAM,CAAC,IAAK,CAAC,SAAS,GAAG,EAAE,CAAE,sBAC/E,MAAM,CAAC,IAAI,mBAAgB;gBACnD,oBAAC,WAAI,IAAC,SAAS,EAAE,8BAAM,CAAC,mBAAmB,EACrC,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,iBACd,MAAM,GAAG,CACvB,CACM,CACf,CAAC;IACJ,CAAC;IAED;;;;OAIG;IACK,oCAAiB,GAAzB,UAA2B,OAA0B;QACnD,IAAM,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;QAE1B,MAAM,CAAC,CACL,oBAAC,qBAAW,IAAC,OAAO,EAAE,MAAM,CAAC,IAAI,EACpB,EAAE,EAAK,MAAM,CAAC,IAAI,mBAAgB,EAClC,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;YACxC,6BAAK,SAAS,EAAE,8BAAM,CAAC,2BAA2B,sBACxB,MAAM,CAAC,IAAI,mBAAgB;gBACnD,oBAAC,WAAI,IAAC,SAAS,EAAE,8BAAM,CAAC,wBAAwB,EAC1C,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,iBACd,MAAM,GAAG,CACvB,CACM,CACf,CAAC;IACJ,CAAC;IAED;;;;OAIG;IACK,qCAAkB,GAA1B,UAA4B,OAA0B;QACpD,IAAM,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;QAE1B,MAAM,CAAC,CACL,oBAAC,qBAAW,IAAC,OAAO,EAAE,MAAM,CAAC,IAAI,EACpB,EAAE,EAAK,MAAM,CAAC,IAAI,mBAAgB,EAClC,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;YACxC,6BAAK,SAAS,EAAE,8BAAM,CAAC,2BAA2B,sBACxB,MAAM,CAAC,IAAI,mBAAgB;gBACnD,oBAAC,WAAI,IAAC,SAAS,EAAE,8BAAM,CAAC,wBAAwB,EAC1C,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,iBACd,MAAM,GAAG,CACvB,CACM,CACf,CAAC;IACJ,CAAC;IAED;;;;OAIG;IACK,qCAAkB,GAA1B,UAA4B,MAAuB;QACjD,MAAM,CAAC,CACL,oBAAC,qBAAW,IAAC,OAAO,EAAE,MAAM,CAAC,IAAI,EACpB,EAAE,EAAK,MAAM,CAAC,IAAI,mBAAgB,EAClC,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;YACxC,6BAAK,SAAS,EAAK,8BAAM,CAAC,qBAAqB,UAAI,MAAM,CAAC,IAAK,CAAC,SAAS,GAAG,MAAM,CAAC,IAAK,CAAC,SAAS,GAAG,EAAE,CAAE,sBAC/E,MAAM,CAAC,IAAI,mBAAgB;gBACnD,oBAAC,WAAI,IAAC,SAAS,EAAE,8BAAM,CAAC,mBAAmB,EACrC,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,iBACd,MAAM,GAAG,CACvB,CACM,CACf,CAAC;IACJ,CAAC;IAED;;OAEG;IACK,0CAAuB,GAA/B;QACE,MAAM,CAAC,CACL,oBAAC,qBAAW,IAAC,OAAO,EAAE,aAAa,EACtB,EAAE,EAAE,2BAA2B,EAC/B,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;YACxC,6BAAK,SAAS,EAAE,8BAAM,CAAC,2BAA2B,sBAC3B,2BAA2B;gBAChD,oBAAC,WAAI,IAAC,SAAS,EAAE,8BAAM,CAAC,wBAAwB,EAC1C,QAAQ,EAAE,cAAc,iBACZ,MAAM,GAAG,CACvB,CACM,CACf,CAAC;IACJ,CAAC;IAmDD;;OAEG;IACI,yBAAM,GAAb;QAAA,iBA8LC;QA7LS,IAAA,sBAAI,CAAgB;QACpB,IAAA,kCAAU,CAAgB;QAElC,mEAAmE;QACnE,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;YAChB,MAAM,CAAC,CACL,6BAAK,SAAS,EAAE,eAAa,8BAAM,CAAC,QAAQ,SAAI,IAAI,CAAC,KAAK,CAAC,SAAW,EACjE,uBAAuB,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,GACxC,CACP,CAAC;QACJ,CAAC;QAED,4BAA4B;QACtB,IAAA,eAAwI,EAAtI,4BAAW,EAAE,oBAA0G,EAA1F,0BAAU,EAAE,sBAAQ,EAAE,0BAAU,EAAE,gCAAa,EAAE,wBAAS,EAAE,sBAAQ,EAAE,sBAAQ,EAAE,sBAAQ,CAAkB;QAE/I,kCAAkC;QAClC,IAAM,OAAO,GAAG;YACd,OAAO,EAAE;gBACP,SAAS,EAAE,GAAG,GAAG,IAAI,CAAC,UAAU;gBAChC,QAAQ,EAAE;oBACR,MAAM,CAAC,iDAAiD;iBACzD;aACF;YACD,SAAS,EAAE;gBACT,WAAW,EAAE,KAAK,CAAC,uEAAuE;aAC3F;SACF,CAAC;QAEF,iDAAiD;QACjD,IAAI,IAAI,GAAG,mBAAK,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;QACxC,IAAI,CAAC,SAAS,GAAG,CAAC,UAAU,CAAC,CAAC;QAC9B,mBAAK,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAE3B,4CAA4C;QAC5C,IAAI,MAAM,GAAG,mBAAK,CAAC,MAAM,CAAC,gBAAgB,CAAC,CAAC;QAC5C,MAAM,CAAC,OAAO,GAAG;YACf,IAAI;YACJ,IAAI;YACJ,IAAI;YACJ,IAAI;YACJ,IAAI;YACJ,IAAI;YACJ,YAAY;SAAC,CAAC;QAChB,mBAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QAE7B,gCAAgC;QAChC,IAAI,SAAS,GAAG,mBAAK,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;QAC7C,SAAS,CAAC,SAAS,GAAG;YACpB,OAAO;YACP,QAAQ;YACR,YAAY;YACZ,OAAO;YACP,QAAQ;YACR,YAAY;YACZ,SAAS;YACT,UAAU;YACV,aAAa;YACb,OAAO;SAAC,CAAC;QACX,mBAAK,CAAC,QAAQ,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QAEhC,MAAM,CAAC,CACL,6BAAK,GAAG,EAAE,UAAC,GAAG,IAAK,OAAA,KAAI,CAAC,WAAW,GAAG,GAAG,EAAtB,CAAsB,EAAE,SAAS,EAAE,CAAG,8BAAM,CAAC,QAAQ,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,WAAW,GAAG,EAAE,UAAI,IAAI,CAAC,KAAK,CAAC,SAAW;YACzI,6BAAK,EAAE,EAAE,IAAI,CAAC,UAAU,EAAE,KAAK,EAAE,EAAC,GAAG,EAAC,IAAI,CAAC,KAAK,CAAC,UAAU,EAAC;gBAExD,UAAU,IAAI,CACZ,oBAAC,mBAAQ,IACvB,EAAE,EAAC,gBAAgB,EACL,SAAS,EAAK,8BAAM,CAAC,cAAc,SAAI,8BAAM,CAAC,eAAiB,EACrD,iBAAiB,EAAE,cAAM,OAAA,oBAAC,WAAI,IAAC,SAAS,EAAE,8BAAM,CAAC,mBAAmB,EAAE,QAAQ,EAAC,iBAAiB,GAAG,EAA1E,CAA0E,EACnG,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,IAAI,CAAC,EAC3C,OAAO,EAAE,IAAI,CAAC,WAAW,EACzB,SAAS,EAAE,IAAI,CAAC,eAAe,EAC/B,cAAc,EAAE,IAAI,CAAC,mBAAmB,EACxC,aAAa,EAAE,IAAI,CAAC,kBAAkB,GACtC,CACX;gBAGD,QAAQ,IAAI,CACV,oBAAC,qBAAW,IAAC,OAAO,EAAE,OAAO,CAAC,SAAS,EAC1B,EAAE,EAAC,qBAAqB,EACxB,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;oBACxC,oBAAC,mBAAU,IAAC,SAAS,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,sBACd,qBAAqB,EACtC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,EAChC,OAAO,EAAE,IAAI,CAAC,YAAY,GAAI,CAC9B,CACf;gBAGD,UAAU,IAAI,CACZ,oBAAC,qBAAW,IAAC,OAAO,EAAE,OAAO,CAAC,WAAW,EAC5B,EAAE,EAAC,uBAAuB,EAC1B,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;oBACxC,oBAAC,mBAAU,IAAC,SAAS,EAAE,EAAE,QAAQ,EAAE,QAAQ,EAAE,sBAChB,uBAAuB,EACxC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,EAClC,OAAO,EAAE,IAAI,CAAC,cAAc,GAAI,CAChC,CACf;gBAGD,aAAa,IAAI,CACf,oBAAC,qBAAW,IAAC,OAAO,EAAE,OAAO,CAAC,cAAc,EAC/B,EAAE,EAAC,0BAA0B,EAC7B,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;oBACxC,oBAAC,mBAAU,IAAC,SAAS,EAAE,EAAE,QAAQ,EAAE,WAAW,EAAE,sBACnB,0BAA0B,EAC3C,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,EACrC,OAAO,EAAE,IAAI,CAAC,iBAAiB,GAAI,CACrC,CACb;gBAGD,SAAS,IAAI,CACX,oBAAC,mBAAQ,IAAC,SAAS,EAAE,KAAG,8BAAM,CAAC,eAAiB,EAChD,EAAE,EAAC,eAAe,EACR,iBAAiB,EAAE,cAAM,OAAA,oBAAC,WAAI,IAAC,SAAS,EAAE,8BAAM,CAAC,mBAAmB,EAAE,QAAQ,EAAC,iBAAiB,GAAG,EAA1E,CAA0E,EACnG,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,IAAI,MAAM,EAC/C,OAAO,EAAE,IAAI,CAAC,WAAW,EACzB,SAAS,EAAE,IAAI,CAAC,aAAa,EAC7B,cAAc,EAAE,IAAI,CAAC,mBAAmB,EACxC,aAAa,EAAE,IAAI,CAAC,kBAAkB,GAC9C,CACH;gBAGD,QAAQ,IAAI,CACV,oBAAC,mBAAQ,IAAC,SAAS,EAAE,8BAAM,CAAC,eAAe,EAC3C,EAAE,EAAC,eAAe,EACR,iBAAiB,EAAE,cAAM,OAAA,oBAAC,WAAI,IAAC,SAAS,EAAE,8BAAM,CAAC,mBAAmB,EAAE,QAAQ,EAAC,iBAAiB,GAAG,EAA1E,CAA0E,EACnG,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,EACpC,OAAO,EAAE,IAAI,CAAC,UAAU;oBACxB,mCAAmC;oBACnC,8EAA8E;oBAC9E,SAAS,EAAE,IAAI,CAAC,YAAY,EAC5B,cAAc,EAAE,IAAI,CAAC,kBAAkB,EACvC,aAAa,EAAE,IAAI,CAAC,iBAAiB,EACrC,mBAAmB,EAAE,IAAI,CAAC,uBAAuB,GACzD,CACH;gBAGD,QAAQ,IAAI,CACV,oBAAC,qBAAW,IAAC,OAAO,EAAE,OAAO,CAAC,SAAS,EAC1B,EAAE,EAAC,qBAAqB,EACxB,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;oBACxC,oBAAC,mBAAU,IAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAQ,CAAC,IAAI,KAAK,SAAS,EAC/C,OAAO,EAAE,IAAI,CAAC,oBAAoB,sBACjB,qBAAqB,EACtC,SAAS,EAAE;4BACT,QAAQ,EAAE,MAAM;yBACjB,GAAI,CACL,CACf;gBAGD,QAAQ,IAAI,CACV,oBAAC,qBAAW,IAAC,OAAO,EAAE,OAAO,CAAC,SAAS,EAC1B,EAAE,EAAC,qBAAqB,EACxB,YAAY,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE;oBACxC,oBAAC,mBAAU,IAAC,SAAS,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,sBACd,qBAAqB,EACtC,OAAO,EAAE,IAAI,CAAC,cAAc,GAAI,CAChC,CACf,CAEC;YAEN,oBAAC,qBAAU,IAAC,GAAG,EAAE,IAAI,CAAC,SAAS,EACnB,WAAW,EAAE,WAAW,EACxB,OAAO,EAAE,OAAO,EAChB,KAAK,EAAE,IAAI,IAAI,EAAE,EACjB,QAAQ,EAAE,IAAI,CAAC,YAAY,EAC3B,iBAAiB,EAAE,IAAI,CAAC,qBAAqB,EAC7C,OAAO,EAAE,IAAI,CAAC,aAAa,GAAI;YAE3C,oBAAC,8BAAoB,IAAC,GAAG,EAAE,IAAI,CAAC,gBAAgB,EAC1B,MAAM,EAAE,IAAI,CAAC,SAAS,EAAE,EACxB,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,eAAe,EAClC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAC9B,MAAM,EAAE,IAAI,CAAC,oBAAoB,EACjC,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,YAAY,GAAG;YAG5D,IAAI,CAAC,gBAAgB,EAAE,CAErB,CACP,CAAC;IACJ,CAAC;IAsHD;;;;OAIG;IACK,8BAAW,GAAnB,UAAoB,IAAY,EAAE,KAAU;QAA5C,iBAQC;QAPC,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QAC/B,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QAE1B,kFAAkF;QAClF,UAAU,CAAC;YACT,KAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,YAAY,EAAE,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;QACzE,CAAC,EAAE,GAAG,CAAC,CAAC;IACV,CAAC;IArnBD;;OAEG;IACW,qBAAY,GAA4B;QACpD,UAAU,EAAE,IAAI;QAChB,YAAY,EAAE;YACZ,UAAU,EAAE,IAAI;YAChB,QAAQ,EAAE,IAAI;YACd,UAAU,EAAE,IAAI;YAChB,aAAa,EAAE,IAAI;YACnB,SAAS,EAAE,IAAI;YACf,QAAQ,EAAE,IAAI;YACd,QAAQ,EAAE,IAAI;YACd,QAAQ,EAAE,IAAI;SACf;KACF,CAAC;IAstBJ,eAAC;CA7xBD,AA6xBC,CA7xB6B,KAAK,CAAC,SAAS,GA6xB5C;AA7xBY,4BAAQ","file":"controls/richText/RichText.js","sourcesContent":["import * as React from 'react';\r\nimport * as strings from 'ControlStrings';\r\nimport 'react-quill/dist/quill.snow.css';\r\nimport RichTextPropertyPane from './RichTextPropertyPane';\r\nimport ReactQuill, { Quill } from 'react-quill';\r\nimport styles from './RichText.module.scss';\r\nimport { IRichTextProps, IRichTextState } from './RichText.types';\r\nimport { IconButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { Guid } from '@microsoft/sp-core-library';\r\nimport { TooltipHost } from 'office-ui-fabric-react/lib/Tooltip';\r\nimport { Dialog, DialogType, DialogFooter } from 'office-ui-fabric-react/lib/Dialog';\r\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Link } from 'office-ui-fabric-react/lib/Link';\r\nimport { PrimaryButton, DefaultButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Icon } from 'office-ui-fabric-react/lib/Icon';\r\nimport { elementContains } from 'office-ui-fabric-react/lib/Utilities';\r\nimport * as telemetry from '../../common/telemetry';\r\nimport { initializeIcons } from 'office-ui-fabric-react/lib/Icons';\r\nimport isEqual = require('lodash/isEqual');\r\n\r\n\r\nconst TOOLBARPADDING: number = 28;\r\n/**\r\n * Creates a rich text editing control that mimics the out-of-the-box\r\n * SharePoint Rich Text control.\r\n * NOTE:\r\n * Quill.js has a few quirks that we can't work around\r\n * - Block quotes only work on single lines. This is a frequently-requested feature with Quill that isn't available yet.\r\n * - Tables aren't supported yet. I'll gladly add table formatting support if users request it.\r\n */\r\n\r\ninitializeIcons();\r\n\r\nexport class RichText extends React.Component<IRichTextProps, IRichTextState> {\r\n  private _quillElem: ReactQuill = undefined;\r\n  private _wrapperRef: HTMLDivElement = undefined;\r\n  private _propertyPaneRef: RichTextPropertyPane = undefined;\r\n  private _toolbarId = undefined;\r\n\r\n  private ddStyleOpts = [{\r\n    key: 0,\r\n    text: strings.HeaderNormalText,\r\n    data: { }\r\n  }, {\r\n    key: 2,\r\n    text: strings.HeaderH2,\r\n    data:\r\n      { className: styles.toolbarButtonH2 }\r\n  }, {\r\n    key: 3,\r\n    text: strings.HeaderH3,\r\n    data:\r\n      { className: styles.toolbarButtonH3 }\r\n  }, {\r\n    key: 4,\r\n    text: strings.HeaderH4,\r\n    data:\r\n      { className: styles.toolbarButtonH4 }\r\n  }, {\r\n    key: 7,\r\n    text: strings.HeaderBlockQuote,\r\n    data:\r\n      { className: styles.toolbarButtonBlockQuote }\r\n  }];\r\n\r\n  private ddAlignOpts = [{\r\n    key: 'left',\r\n    text: strings.AlignLeft,\r\n    data: { icon: 'AlignLeft' }\r\n  }, {\r\n    key: 'center',\r\n    text: strings.AlignCenter,\r\n    data: { icon: 'AlignCenter' }\r\n  }, {\r\n    key: 'right',\r\n    text: strings.AlignRight,\r\n    data: { icon: 'AlignRight' }\r\n  }];\r\n\r\n  private ddListOpts = [{\r\n    key: 'bullet',\r\n    text: strings.ListBullet,\r\n    data: { icon: 'BulletedList' }\r\n  }, {\r\n    key: 'ordered',\r\n    text: strings.ListNumbered,\r\n    data: { icon: 'NumberedList' }\r\n  }];\r\n\r\n  /**\r\n   * Sets default properties\r\n   */\r\n  public static defaultProps: Partial<IRichTextProps> = {\r\n    isEditMode: true,\r\n    styleOptions: {\r\n      showStyles: true,\r\n      showBold: true,\r\n      showItalic: true,\r\n      showUnderline: true,\r\n      showAlign: true,\r\n      showList: true,\r\n      showLink: true,\r\n      showMore: true\r\n    }\r\n  };\r\n\r\n  constructor(props: IRichTextProps) {\r\n    super(props);\r\n    telemetry.track('ReactRichText', {\r\n      className: !!props.className\r\n    });\r\n\r\n    this.state = {\r\n      text: this.props.value,\r\n      editing: false,\r\n      morePaneVisible: false,\r\n      hideDialog: true,\r\n      formats: {},\r\n      insertUrl: undefined,\r\n      insertUrlText: undefined,\r\n      selectedText: undefined,\r\n      selectedUrl: undefined,\r\n      wrapperTop: 0\r\n    };\r\n\r\n    // Get a unique toolbar id\r\n    this._toolbarId = \"toolbar_\" + Guid.newGuid().toString();\r\n  }\r\n\r\n  /**\r\n   * Attaches to mouse down events to determine if we clicked outside\r\n   */\r\n  public componentDidMount() {\r\n    // If we're in edit mode, attach the mouse down event\r\n    if (this.props.isEditMode) {\r\n      document.addEventListener('click', this.handleClickOutside);\r\n      document.addEventListener('focus', this.handleClickOutside);\r\n\r\n      const clientRect: ClientRect = this._wrapperRef.getBoundingClientRect();\r\n      const parentClientRect: ClientRect = this._wrapperRef.parentElement.getBoundingClientRect();\r\n      const toolbarTop: number = clientRect.top - parentClientRect.top - TOOLBARPADDING;\r\n\r\n      this.setState({\r\n        wrapperTop: toolbarTop\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Removes the mouse down event\r\n   */\r\n  public componentWillUnmount() {\r\n    // If we were in edit mode, remove the mouse down handler\r\n    if (this.props.isEditMode) {\r\n      document.removeEventListener('click', this.handleClickOutside);\r\n      document.removeEventListener('focus', this.handleClickOutside);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * If we're switching from non-edit mode to edit mode, attach mouse down event\r\n   * If we're going from edit mode to non-edit mode, remove mouse down event\r\n   * @param prevProps\r\n   * @param prevState\r\n   */\r\n  public componentDidUpdate(prevProps: IRichTextProps, prevState: IRichTextState): void {\r\n    // If we're going from non-edit to edit mode\r\n    if (this.props.isEditMode && !prevProps.isEditMode) {\r\n      document.addEventListener('click', this.handleClickOutside);\r\n      document.addEventListener('focus', this.handleClickOutside);\r\n    }\r\n\r\n    // If we're going from edit mode to non-edit mode\r\n    if (!this.props.isEditMode && prevProps.isEditMode) {\r\n      document.removeEventListener('click', this.handleClickOutside);\r\n      document.removeEventListener('focus', this.handleClickOutside);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * shouldComponentUpdate lifecycle hook\r\n   *\r\n   * @param nextProps\r\n   * @param nextState\r\n   */\r\n  public shouldComponentUpdate(nextProps: IRichTextProps, nextState: IRichTextState): boolean {\r\n    // Checks if the value coming in is the same\r\n    if (isEqual(nextState, this.state)) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Returns a handle to the Quill editor\r\n   */\r\n  public getEditor = (): Quill => {\r\n    try {\r\n      return this._quillElem!.getEditor();\r\n    } catch (error) {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Render style option\r\n   *\r\n   * @param option\r\n   */\r\n  private onRenderStyleOption (option: IDropdownOption): JSX.Element {\r\n    return (\r\n      <TooltipHost content={option.text}\r\n                   id={`${option.text}-toolbarButton`}\r\n                   calloutProps={{ gapSpace: 0 }}>\r\n        <div className={`${styles.toolbarDropDownOption} ${option.data!.className ? option.data!.className : \"\"}`}\r\n             aria-describedby={`${option.text}-toolbarButton`}>\r\n          <span>{option.text}</span>\r\n        </div>\r\n      </TooltipHost>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Render the title of the style dropdown\r\n   *\r\n   * @param options\r\n   */\r\n  private onRenderStyleTitle (options: IDropdownOption[]): JSX.Element {\r\n    const option = options[0];\r\n\r\n    return (\r\n      <TooltipHost content={option.text}\r\n                   id={`${option.text}-dropDownTitle`}\r\n                   calloutProps={{ gapSpace: 0 }}>\r\n        <div className={styles.toolbarSubmenuDisplayButton}\r\n             aria-describedby={`${option.text}-dropDownTitle`}>\r\n          <span>{option.text}</span>\r\n        </div>\r\n      </TooltipHost>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Render align option\r\n   *\r\n   * @param option\r\n   */\r\n  private onRenderAlignOption (option: IDropdownOption): JSX.Element {\r\n    return (\r\n      <TooltipHost content={option.text}\r\n                   id={`${option.text}-toolbarButton`}\r\n                   calloutProps={{ gapSpace: 0 }}>\r\n        <div className={`${styles.toolbarDropDownOption} ${option.data!.className ? option.data!.className : \"\"}`}\r\n             aria-describedby={`${option.text}-toolbarButton`}>\r\n          <Icon className={styles.toolbarDropDownIcon}\r\n                iconName={option.data.icon}\r\n                aria-hidden=\"true\" />\r\n        </div>\r\n      </TooltipHost>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Render the list dropdown title\r\n   *\r\n   * @param options\r\n   */\r\n  private onRenderListTitle (options: IDropdownOption[]): JSX.Element {\r\n    const option = options[0];\r\n\r\n    return (\r\n      <TooltipHost content={option.text}\r\n                   id={`${option.text}-dropDownTitle`}\r\n                   calloutProps={{ gapSpace: 0 }}>\r\n        <div className={styles.toolbarSubmenuDisplayButton}\r\n             aria-describedby={`${option.text}-dropDownTitle`}>\r\n          <Icon className={styles.toolbarDropDownTitleIcon}\r\n                iconName={option.data.icon}\r\n                aria-hidden=\"true\" />\r\n        </div>\r\n      </TooltipHost>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Render the title of the align dropdown\r\n   *\r\n   * @param options\r\n   */\r\n  private onRenderAlignTitle (options: IDropdownOption[]): JSX.Element {\r\n    const option = options[0];\r\n\r\n    return (\r\n      <TooltipHost content={option.text}\r\n                   id={`${option.text}-dropDownTitle`}\r\n                   calloutProps={{ gapSpace: 0 }}>\r\n        <div className={styles.toolbarSubmenuDisplayButton}\r\n             aria-describedby={`${option.text}-dropDownTitle`}>\r\n          <Icon className={styles.toolbarDropDownTitleIcon}\r\n                iconName={option.data.icon}\r\n                aria-hidden=\"true\" />\r\n        </div>\r\n      </TooltipHost>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Render list dropdown option\r\n   *\r\n   * @param option\r\n   */\r\n  private onRenderListOption (option: IDropdownOption): JSX.Element {\r\n    return (\r\n      <TooltipHost content={option.text}\r\n                   id={`${option.text}-toolbarButton`}\r\n                   calloutProps={{ gapSpace: 0 }}>\r\n        <div className={`${styles.toolbarDropDownOption} ${option.data!.className ? option.data!.className : \"\"}`}\r\n             aria-describedby={`${option.text}-toolbarButton`}>\r\n          <Icon className={styles.toolbarDropDownIcon}\r\n                iconName={option.data.icon}\r\n                aria-hidden=\"true\" />\r\n        </div>\r\n      </TooltipHost>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Render the list dropdown placeholder\r\n   */\r\n  private onRenderListPlaceholder (): JSX.Element {\r\n    return (\r\n      <TooltipHost content={\"Placeholder\"}\r\n                   id={`Placeholder-dropDownTitle`}\r\n                   calloutProps={{ gapSpace: 0 }}>\r\n        <div className={styles.toolbarSubmenuDisplayButton}\r\n             aria-describedby={`Placeholder-dropDownTitle`}>\r\n          <Icon className={styles.toolbarDropDownTitleIcon}\r\n                iconName={'BulletedList'}\r\n                aria-hidden=\"true\" />\r\n        </div>\r\n      </TooltipHost>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Renders the \"Insert Link\" dialog\r\n   */\r\n  private renderLinkDialog = (): JSX.Element => {\r\n    return (\r\n      <Dialog hidden={this.state.hideDialog}\r\n              onDismiss={this.closeDialog}\r\n              dialogContentProps={{\r\n                type: DialogType.normal,\r\n                title: strings.InsertLinkTitle,\r\n              }}\r\n              modalProps={{\r\n                className: styles.insertLinkDialog,\r\n                isBlocking: true,\r\n                containerClassName: 'ms-dialogMainOverride'\r\n              }}>\r\n        <TextField label={strings.AddressFieldLabel}\r\n                   value={this.state.insertUrl !== undefined ? this.state.insertUrl : \"https://\"}\r\n                   onChanged={(newValue?: string) => {\r\n                    this.setState({\r\n                      insertUrl: newValue\r\n                    });\r\n                  }} />\r\n\r\n        <TextField label={strings.TextToDisplayLabel}\r\n                   value={this.state.insertUrlText || this.state.insertUrl}\r\n                   onChanged={(newValue?: string) => {\r\n                    if (newValue !== this.state.insertUrl) {\r\n                      this.setState({\r\n                        insertUrlText: newValue\r\n                      });\r\n                    }\r\n                   }} />\r\n\r\n        <DialogFooter className={styles.actions}>\r\n          <div className={`ms-Dialog-actionsRight ${styles.actionsRight}`}>\r\n            {\r\n              this.state.selectedUrl && (\r\n                <Link className={`${styles.action} ${styles.unlinkButton}`} onClick={this.handleRemoveLink}>{strings.RemoveLinkLabel}</Link>\r\n              )\r\n            }\r\n            <PrimaryButton className={styles.action} onClick={this.handleCreateLink} text={strings.SaveButtonLabel} />\r\n            <DefaultButton className={styles.action} onClick={this.closeDialog} text={strings.CancelButtonLabel} />\r\n          </div>\r\n        </DialogFooter>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Renders the Rich Text Editor\r\n   */\r\n  public render(): React.ReactElement<IRichTextProps> {\r\n    const { text } = this.state;\r\n    const { isEditMode } = this.props;\r\n\r\n    // If we're not in edit mode, display read-only version of the html\r\n    if (!isEditMode) {\r\n      return (\r\n        <div className={`ql-editor ${styles.richtext} ${this.props.className}`}\r\n             dangerouslySetInnerHTML={{ __html: text }}>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // Okay, we're in edit mode.\r\n    const { placeholder, styleOptions: { showStyles, showBold, showItalic, showUnderline, showAlign, showList, showLink, showMore } } = this.props;\r\n\r\n    // Get a unique id for the toolbar\r\n    const modules = {\r\n      toolbar: {\r\n        container: \"#\" + this._toolbarId,\r\n        handlers: [\r\n          \"link\" // disable the link handler so we can add our own\r\n        ]\r\n      },\r\n      clipboard: {\r\n        matchVisual: false // prevents weird bug that inserts blank lines when loading stored text\r\n      }\r\n    };\r\n\r\n    // Remove fonts and set Segoe UI as the main font\r\n    let font = Quill.import('formats/font');\r\n    font.whitelist = ['Segoe UI'];\r\n    Quill.register(font, true);\r\n\r\n    // Set headers and add blockquote capability\r\n    let header = Quill.import('formats/header');\r\n    header.tagName = [\r\n      'H1',\r\n      'H2',\r\n      'H3',\r\n      'H4',\r\n      'H5',\r\n      'H6',\r\n      'blockquote'];\r\n    Quill.register(header, true);\r\n\r\n    // Add the SharePoint font sizes\r\n    let SizeClass = Quill.import('formats/size');\r\n    SizeClass.whitelist = [\r\n      'small',\r\n      'medium',\r\n      'mediumplus',\r\n      'large',\r\n      'xlarge',\r\n      'xlargeplus',\r\n      'xxlarge',\r\n      'xxxlarge',\r\n      'xxlargeplus',\r\n      'super'];\r\n    Quill.register(SizeClass, true);\r\n\r\n    return (\r\n      <div ref={(ref) => this._wrapperRef = ref} className={`${styles.richtext && this.state.editing ? 'ql-active' : ''} ${this.props.className}`}>\r\n        <div id={this._toolbarId} style={{top:this.state.wrapperTop}}>\r\n          {\r\n            showStyles && (\r\n              <Dropdown\r\nid=\"DropDownStyles\"\r\n              className={`${styles.headerDropDown} ${styles.toolbarDropDown}`}\r\n                        onRenderCaretDown={() => <Icon className={styles.toolbarSubmenuCaret} iconName=\"CaretDownSolid8\" />}\r\n                        selectedKey={this.state.formats.header || 0}\r\n                        options={this.ddStyleOpts}\r\n                        onChanged={this.onChangeHeading}\r\n                        onRenderOption={this.onRenderStyleOption}\r\n                        onRenderTitle={this.onRenderStyleTitle}\r\n                      />\r\n            )\r\n          }\r\n          {\r\n            showBold && (\r\n              <TooltipHost content={strings.BoldTitle}\r\n                           id=\"bold-richtextbutton\"\r\n                           calloutProps={{ gapSpace: 0 }}>\r\n                <IconButton iconProps={{ iconName: 'Bold' }}\r\n                            aria-describedby=\"bold-richtextbutton\"\r\n                            checked={this.state.formats.bold}\r\n                            onClick={this.onChangeBold} />\r\n              </TooltipHost>\r\n            )\r\n          }\r\n          {\r\n            showItalic && (\r\n              <TooltipHost content={strings.ItalicTitle}\r\n                           id=\"italic-richtextbutton\"\r\n                           calloutProps={{ gapSpace: 0 }}>\r\n                <IconButton iconProps={{ iconName: 'Italic' }}\r\n                            aria-describedby=\"italic-richtextbutton\"\r\n                            checked={this.state.formats.italic}\r\n                            onClick={this.onChangeItalic} />\r\n              </TooltipHost>\r\n            )\r\n          }\r\n          {\r\n            showUnderline && (\r\n              <TooltipHost content={strings.UnderlineTitle}\r\n                           id=\"underline-richtextbutton\"\r\n                           calloutProps={{ gapSpace: 0 }}>\r\n                <IconButton iconProps={{ iconName: 'Underline' }}\r\n                            aria-describedby=\"underline-richtextbutton\"\r\n                            checked={this.state.formats.underline}\r\n                            onClick={this.onChangeUnderline} />\r\n            </TooltipHost>\r\n            )\r\n          }\r\n          {\r\n            showAlign && (\r\n              <Dropdown className={`${styles.toolbarDropDown}`}\r\n              id=\"DropDownAlign\"\r\n                        onRenderCaretDown={() => <Icon className={styles.toolbarSubmenuCaret} iconName=\"CaretDownSolid8\" />}\r\n                        selectedKey={this.state.formats.align || 'left'}\r\n                        options={this.ddAlignOpts}\r\n                        onChanged={this.onChangeAlign}\r\n                        onRenderOption={this.onRenderAlignOption}\r\n                        onRenderTitle={this.onRenderAlignTitle}\r\n              />\r\n            )\r\n          }\r\n          {\r\n            showList && (\r\n              <Dropdown className={styles.toolbarDropDown}\r\n              id=\"DropDownLists\"\r\n                        onRenderCaretDown={() => <Icon className={styles.toolbarSubmenuCaret} iconName=\"CaretDownSolid8\" />}\r\n                        selectedKey={this.state.formats.list}\r\n                        options={this.ddListOpts}\r\n                        // this option is not available yet\r\n                        // notifyOnReselect={true} // allows re-selecting selected item to turn it off\r\n                        onChanged={this.onChangeList}\r\n                        onRenderOption={this.onRenderListOption}\r\n                        onRenderTitle={this.onRenderListTitle}\r\n                        onRenderPlaceHolder={this.onRenderListPlaceholder}\r\n              />\r\n            )\r\n          }\r\n          {\r\n            showLink && (\r\n              <TooltipHost content={strings.LinkTitle}\r\n                           id=\"link-richtextbutton\"\r\n                           calloutProps={{ gapSpace: 0 }}>\r\n                <IconButton checked={this.state.formats!.link !== undefined}\r\n                            onClick={this.showInsertLinkDialog}\r\n                            aria-describedby=\"link-richtextbutton\"\r\n                            iconProps={{\r\n                              iconName: 'Link'\r\n                            }} />\r\n              </TooltipHost>\r\n            )\r\n          }\r\n          {\r\n            showMore && (\r\n              <TooltipHost content={strings.MoreTitle}\r\n                           id=\"more-richtextbutton\"\r\n                           calloutProps={{ gapSpace: 0 }}>\r\n                <IconButton iconProps={{ iconName: 'More' }}\r\n                            aria-describedby=\"more-richtextbutton\"\r\n                            onClick={this.handleShowMore} />\r\n              </TooltipHost>\r\n            )\r\n          }\r\n        </div>\r\n\r\n        <ReactQuill ref={this.linkQuill}\r\n                    placeholder={placeholder}\r\n                    modules={modules}\r\n                    value={text || ''}\r\n                    onChange={this.handleChange}\r\n                    onChangeSelection={this.handleChangeSelection}\r\n                    onFocus={this.handleOnFocus} />\r\n\r\n        <RichTextPropertyPane ref={this.linkPropertyPane}\r\n                              editor={this.getEditor()}\r\n                              isOpen={this.state.morePaneVisible}\r\n                              onClose={this.handleClosePanel}\r\n                              onLink={this.showInsertLinkDialog} \r\n                              customColors={this.props.customColors}/>\r\n\r\n        {\r\n          this.renderLinkDialog()\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Style trigger events\r\n   */\r\n  private onChangeBold = (): void => {\r\n    const newBoldValue = !this.state.formats.bold;\r\n    this.applyFormat(\"bold\", newBoldValue);\r\n  }\r\n\r\n  private onChangeItalic = (): void => {\r\n    const newValue = !this.state.formats.italic;\r\n    this.applyFormat(\"italic\", newValue);\r\n  }\r\n\r\n  private onChangeUnderline = (): void => {\r\n    const newValue = !this.state.formats.underline;\r\n    this.applyFormat(\"underline\", newValue);\r\n  }\r\n  private onChangeHeading = (item: IDropdownOption): void => {\r\n    const newHeadingValue = item.key === 0 ? '' : item.key.toString();\r\n    this.applyFormat(\"header\", newHeadingValue);\r\n  }\r\n\r\n  private onChangeAlign = (item: IDropdownOption): void => {\r\n    const newAlignValue = item.key === 'left' ? false : item.key.toString();\r\n    this.applyFormat(\"align\", newAlignValue);\r\n  }\r\n\r\n  private onChangeList = (item: IDropdownOption): void => {\r\n    // if we're already in list mode, toggle off\r\n    const key = item.key;\r\n    const newAlignValue = (key === 'bullet' && this.state.formats.list === 'bullet') || (key === 'numbered' && this.state.formats.list === 'numbered') ? false : key;\r\n    this.applyFormat(\"list\", newAlignValue);\r\n  }\r\n\r\n  /**\r\n   * Displays the insert link dialog\r\n   */\r\n  private showInsertLinkDialog = () => {\r\n    const quill = this.getEditor();\r\n    const range = quill.getSelection();\r\n\r\n    let linkText = this.state.selectedText;\r\n    if (this.state.selectedUrl !== undefined && this.state.selectedText === \"\") {\r\n      const { text } = this.state;\r\n      const urlStartIndex = text.indexOf(this.state.selectedUrl);\r\n      const startTextIndex = text.indexOf(\">\", urlStartIndex) + 1;\r\n      const endTextIndex = text.indexOf(\"<\", startTextIndex);\r\n      const realLength = endTextIndex - startTextIndex;\r\n      linkText = text.substr(startTextIndex, realLength);\r\n\r\n      //Find where the link text starts and select that\r\n      const editorText = quill.getText();\r\n      const linkStart = editorText.indexOf(linkText);\r\n      range.index = linkStart;\r\n      range.length = linkText.length;\r\n    }\r\n\r\n    this.setState({\r\n      hideDialog: false,\r\n      insertUrlText: linkText,\r\n      insertUrl: this.state.selectedUrl,\r\n      selectedRange: range\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Hides the insert link dialog\r\n   */\r\n  private closeDialog = () => {\r\n    this.setState({ hideDialog: true });\r\n  }\r\n\r\n  /**\r\n   * When user enters the richtext editor, displays the border\r\n   */\r\n  private handleOnFocus = (range, source, editor) => {\r\n    if (!this.state.editing) {\r\n      this.setState({ editing: true });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called when user removes the link\r\n   */\r\n  private handleRemoveLink = () => {\r\n    const quill = this.getEditor();\r\n    quill.format('link', false);\r\n    this.closeDialog();\r\n  }\r\n\r\n  /**\r\n   * Called when user creates a new link\r\n   */\r\n  private handleCreateLink = () => {\r\n    const quill = this.getEditor();\r\n    const range = this.state.selectedRange;\r\n    const cursorPosition: number = range!.index;\r\n    if (range.length > 0) {\r\n      quill.deleteText(range.index, range.length);\r\n    }\r\n\r\n    if (cursorPosition) {\r\n      const textToInsert: string = this.state.insertUrlText !== undefined ? this.state.insertUrlText : this.state.insertUrl;\r\n      const urlToInsert: string = this.state.insertUrl;\r\n      quill.insertText(cursorPosition, textToInsert);\r\n      quill.setSelection(cursorPosition, textToInsert.length);\r\n      quill.formatText(cursorPosition, textToInsert.length, 'link', urlToInsert);\r\n    }\r\n\r\n    this.setState({\r\n      hideDialog: true,\r\n      insertUrl: undefined,\r\n      insertUrlText: undefined\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Applies a format to the selection\r\n   * @param name format name\r\n   * @param value format value, or false to unset format\r\n   */\r\n  private applyFormat(name: string, value: any) {\r\n    const quill = this.getEditor();\r\n    quill.format(name, value);\r\n\r\n    // We use a timeout to ensure that format has been applied and buttons are updated\r\n    setTimeout(() => {\r\n      this.handleChangeSelection(quill.getSelection(), undefined, undefined);\r\n    }, 100);\r\n  }\r\n\r\n  /**\r\n   * Called when richtext selection changes\r\n   */\r\n  private handleChangeSelection = (range, oldRange, source) => {\r\n    const quill = this.getEditor();\r\n    try {\r\n      if (quill) {\r\n        // Get the selected text\r\n        const selectedText = quill.getText(range);\r\n\r\n        // Get the current format\r\n        const formats = quill.getFormat(range);\r\n\r\n        // Get the currently selected url\r\n        const selectedUrl = formats.link ? formats.link : undefined;\r\n\r\n        this.setState({\r\n          selectedText: selectedText,\r\n          selectedUrl: selectedUrl,\r\n          formats: formats\r\n        });\r\n\r\n        if (this._propertyPaneRef && this.state.morePaneVisible) {\r\n          this._propertyPaneRef.onChangeSelection(range, oldRange, source);\r\n        }\r\n      }\r\n    } catch (error) {\r\n\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called when user clicks on the close icon\r\n   */\r\n  private handleClosePanel = (): void => {\r\n    this.closePanel();\r\n  }\r\n\r\n  /**\r\n   * Closes the panel\r\n   */\r\n  private closePanel = (): void => {\r\n    this.setState({ morePaneVisible: false });\r\n  }\r\n\r\n  /**\r\n   * Called when user clicks on the more button\r\n   */\r\n  private handleShowMore = () => {\r\n    this.setState({\r\n      morePaneVisible: !this.state.morePaneVisible\r\n    }, () => {\r\n      this.getEditor().focus();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Called when user changes the text of the editor\r\n   */\r\n  private handleChange = (value: string) => {\r\n    const { onChange } = this.props;\r\n\r\n    // do we need to pass this to a handler?\r\n    if (onChange) {\r\n      // yes, get the changed text from the handler\r\n      let newText: string = onChange(value);\r\n      this.setState({ text: newText });\r\n    } else {\r\n      // no, write the text to the state\r\n      this.setState({ text: value });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Keeps track of whether we clicked outside the element\r\n   */\r\n  private handleClickOutside = (event) => {\r\n    let outside: boolean = !elementContains(this._wrapperRef, event.target);\r\n\r\n    // Did we click outside?\r\n    if (outside) {\r\n      // If we are currently editing, stop editing\r\n      // -- unless we're using the property pane or the dialog\r\n      if (this.state.editing) {\r\n        this.setState({\r\n          editing: false\r\n        });\r\n      }\r\n    } else {\r\n      // We clicked inside\r\n      if (!this.state.editing) {\r\n        // if we aren't currently editing, start editing\r\n        this.setState({ editing: true });\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Links to the quill reference\r\n   */\r\n  private linkQuill = (e: any) => {\r\n    this._quillElem = e;\r\n  }\r\n\r\n  /**\r\n   * Links to the property pane element\r\n   */\r\n  private linkPropertyPane = (e: any) => {\r\n    this._propertyPaneRef = e;\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}