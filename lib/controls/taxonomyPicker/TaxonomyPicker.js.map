{"version":3,"sources":["controls/taxonomyPicker/TaxonomyPicker.tsx"],"names":[],"mappings":"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","file":"controls/taxonomyPicker/TaxonomyPicker.js","sourcesContent":["import * as React from 'react';\r\nimport { PrimaryButton, DefaultButton, IconButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { Panel, PanelType } from 'office-ui-fabric-react/lib/Panel';\r\nimport { Spinner, SpinnerType } from 'office-ui-fabric-react/lib/Spinner';\r\nimport { Label } from 'office-ui-fabric-react/lib/Label';\r\nimport TermPicker from './TermPicker';\r\nimport { IPickerTerms, IPickerTerm } from './ITermPicker';\r\nimport { ITaxonomyPickerProps, ITaxonomyPickerState } from './ITaxonomyPicker';\r\nimport SPTermStorePickerService from './../../services/SPTermStorePickerService';\r\nimport { ITermSet, ITerm } from './../../services/ISPTermStorePickerService';\r\nimport * as strings from 'ControlStrings';\r\nimport styles from './TaxonomyPicker.module.scss';\r\nimport { sortBy, uniqBy, cloneDeep, isEqual } from '@microsoft/sp-lodash-subset';\r\nimport TermParent from './TermParent';\r\nimport FieldErrorMessage from './ErrorMessage';\r\n\r\nimport * as telemetry from '../../common/telemetry';\r\n\r\n/**\r\n * Image URLs / Base64\r\n */\r\nexport const COLLAPSED_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAUCAYAAABSx2cSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjEwcrIlkgAAAIJJREFUOE/NkjEKwCAMRdu7ewZXJ/EqHkJwE9TBCwR+a6FLUQsRwYBTeD8/35wADnZVmPvY4OOYO3UNbK1FKeUWH+fRtK21hjEG3vuhQBdOKUEpBedcV6ALExFijJBSIufcFBjCVSCEACEEqpNvBmsmT+3MTnvqn/+O4+1vdtv7274APmNjtuXVz6sAAAAASUVORK5CYII='; // /_layouts/15/images/MDNCollapsed.png\r\nexport const EXPANDED_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAUCAYAAABSx2cSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjEwcrIlkgAAAFtJREFUOE9j/P//PwPZAKSZXEy2RrCLybV1CGjetWvX/46ODqBLUQOXoJ9BGtXU1MCYJM0wjZGRkaRpRtZIkmZ0jSRpBgUOzJ8wmqwAw5eICIb2qGYSkyfNAgwAasU+UQcFvD8AAAAASUVORK5CYII='; // /_layouts/15/images/MDNExpanded.png\r\nexport const GROUP_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAC9SURBVDhPY2CgNXh1qEkdiJ8D8X90TNBuJM0V6IpBhoHFgIxebKYTIwYzAMNpxGhGdsFwNoBgNEFjAWsYgOSKiorMgPgbEP/Hgj8AxXpB0Yg1gQAldYuLix8/efLkzn8s4O7du9eAan7iM+DV/v37z546der/jx8/sJkBdhVOA5qbm08ePnwYrOjQoUOkGwDU+AFowLmjR4/idwGukAYaYAkMgxfPnj27h816kDg4DPABoAI/IP6DIxZA4l0AOd9H3QXl5+cAAAAASUVORK5CYII='; // /_layouts/15/Images/EMMGroup.png\r\nexport const TERMSET_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACaSURBVDhPrZLRCcAgDERdpZMIjuQA7uWH4CqdxMY0EQtNjKWB0A/77sxF55SKMTalk8a61lqCFqsLiwKac84ZRUUBi7MoYHVmAfjfjzE6vJqZQfie0AcwBQVW8ATi7AR7zGGGNSE6Q2cyLSPIjRswjO7qKhcPDN2hK46w05wZMcEUIG+HrzzcrRsQBIJ5hS8C9fGAPmRwu/9RFxW6L8CM4Ry8AAAAAElFTkSuQmCC'; // /_layouts/15/Images/EMMTermSet.png\r\nexport const TERM_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACzSURBVDhPY2AYNKCoqIgTiOcD8X8S8F6wB4Aa1IH4akNDw+mPHz++/E8EuHTp0jmQRSDNCcXFxa/XrVt3gAh9KEpgBvx/9OjRLVI1g9TDDYBp3rlz5//Kysr/IJoYgGEASPPatWsbQDQxAMOAbdu2gZ0FookBcAOePHlyhxgN6GqQY+Hdhg0bDpJqCNgAaDrQAnJuNDY2nvr06dMbYgw6e/bsabgBUEN4yEiJ2wdNViLfIQC3sTh2vtJcswAAAABJRU5ErkJggg==';\r\n\r\n/**\r\n * Renders the controls for PropertyFieldTermPicker component\r\n */\r\nexport class TaxonomyPicker extends React.Component<ITaxonomyPickerProps, ITaxonomyPickerState> {\r\n  private termsService: SPTermStorePickerService;\r\n  private previousValues: IPickerTerms = [];\r\n  private cancel: boolean = true;\r\n\r\n  /**\r\n   * Constructor method\r\n   */\r\n  constructor(props: ITaxonomyPickerProps) {\r\n    super(props);\r\n\r\n    telemetry.track('ReactTaxonomyPicker');\r\n\r\n    this.state = {\r\n      activeNodes: this.props.initialValues || [],\r\n      termSetAndTerms: null,\r\n      loaded: false,\r\n      openPanel: false,\r\n      errorMessage: ''\r\n    };\r\n\r\n    this.onOpenPanel = this.onOpenPanel.bind(this);\r\n    this.onClosePanel = this.onClosePanel.bind(this);\r\n    this.onSave = this.onSave.bind(this);\r\n    this.termsChanged = this.termsChanged.bind(this);\r\n    this.termsFromPickerChanged = this.termsFromPickerChanged.bind(this);\r\n  }\r\n\r\n  /**\r\n   * componentWillMount lifecycle hook\r\n   */\r\n  public componentWillMount(): void {\r\n    this.setState({\r\n      activeNodes: this.props.initialValues || []\r\n    });\r\n  }\r\n\r\n  /**\r\n   * componentWillUpdate lifecycle hook\r\n   */\r\n  public componentDidUpdate(prevProps: ITaxonomyPickerProps): void {\r\n    // Check if the initial values objects are not equal, if that is the case, data can be refreshed\r\n    if (!isEqual(this.props.initialValues, prevProps.initialValues)) {\r\n      this.setState({\r\n        activeNodes: this.props.initialValues || []\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Loads the list from SharePoint current web site\r\n   */\r\n  private loadTermStores(): void {\r\n    this.termsService = new SPTermStorePickerService(this.props, this.props.context);\r\n\r\n    if (this.props.termActions && this.props.termActions.initialize) {\r\n      this.props.termActions.initialize(this.termsService);\r\n      // this.props.termActions.actions.forEach(x => {\r\n      //   x.initialize(this.termsService);\r\n      // });\r\n    }\r\n\r\n    this.termsService.getAllTerms(this.props.termsetNameOrID).then((response: ITermSet) => {\r\n      // Check if a response was retrieved\r\n      let termSetAndTerms = response ? response : null;\r\n      this.setState({\r\n        termSetAndTerms,\r\n        loaded: true\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Force update of the taxonomy tree - required by term action in case the term has been added, deleted or moved.\r\n   */\r\n  private async updateTaxonomyTree(): Promise<void> {\r\n    const termSetAndTerms = await this.termsService.getAllTerms(this.props.termsetNameOrID);\r\n\r\n    this.setState({\r\n      termSetAndTerms\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Open the right Panel\r\n   */\r\n  private onOpenPanel(): void {\r\n    if (this.props.disabled === true) {\r\n      return;\r\n    }\r\n\r\n    // Store the current code value\r\n    this.previousValues = cloneDeep(this.state.activeNodes);\r\n    this.cancel = true;\r\n\r\n    this.loadTermStores();\r\n\r\n    this.setState({\r\n      openPanel: true,\r\n      loaded: false\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Close the panel\r\n   */\r\n  private onClosePanel(): void {\r\n\r\n    this.setState(() => {\r\n      const newState: ITaxonomyPickerState = {\r\n        openPanel: false,\r\n        loaded: false\r\n      };\r\n\r\n      // Check if the property has to be reset\r\n      if (this.cancel) {\r\n        newState.activeNodes = this.previousValues;\r\n      }\r\n\r\n      return newState;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * On save click action\r\n   */\r\n  private onSave(): void {\r\n    this.cancel = false;\r\n    this.onClosePanel();\r\n    // Trigger the onChange event\r\n    this.props.onChange(this.state.activeNodes);\r\n  }\r\n\r\n  /**\r\n   * Clicks on a node\r\n   * @param node\r\n   */\r\n  private termsChanged(term: ITerm, checked: boolean): void {\r\n\r\n    let activeNodes = this.state.activeNodes;\r\n    if (typeof term === 'undefined' || term === null) {\r\n      return;\r\n    }\r\n\r\n    // Term item to add to the active nodes array\r\n    const termItem = {\r\n      name: term.Name,\r\n      key: term.Id,\r\n      path: term.PathOfTerm,\r\n      termSet: term.TermSet.Id\r\n    };\r\n\r\n    // Check if the term is checked or unchecked\r\n    if (checked) {\r\n      // Check if it is allowed to select multiple terms\r\n      if (this.props.allowMultipleSelections) {\r\n        // Add the checked term\r\n        activeNodes.push(termItem);\r\n        // Filter out the duplicate terms\r\n        activeNodes = uniqBy(activeNodes, 'key');\r\n      } else {\r\n        // Only store the current selected item\r\n        activeNodes = [termItem];\r\n      }\r\n    } else {\r\n      // Remove the term from the list of active nodes\r\n      activeNodes = activeNodes.filter(item => item.key !== term.Id);\r\n    }\r\n    // Sort all active nodes\r\n    activeNodes = sortBy(activeNodes, 'path');\r\n    // Update the current state\r\n    this.setState({\r\n      activeNodes: activeNodes\r\n    });\r\n  }\r\n\r\n  /**\r\n * Fires When Items Changed in TermPicker\r\n * @param node\r\n */\r\n  private termsFromPickerChanged(terms: IPickerTerms) {\r\n    this.props.onChange(terms);\r\n    this.setState({\r\n      activeNodes: terms\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * Gets the given node position in the active nodes collection\r\n   * @param node\r\n   */\r\n  private getSelectedNodePosition(node: IPickerTerm): number {\r\n    for (let i = 0; i < this.state.activeNodes.length; i++) {\r\n      if (node.key === this.state.activeNodes[i].key) {\r\n        return i;\r\n      }\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  /**\r\n   * TermSet selection handler\r\n   * @param termSet\r\n   * @param isChecked\r\n   */\r\n  private termSetSelectedChange = (termSet: ITermSet, isChecked: boolean) => {\r\n    const ts: ITermSet = {...termSet};\r\n    // Clean /Guid.../ from the ID\r\n    ts.Id = this.termsService.cleanGuid(ts.Id);\r\n    // Create a term for the termset\r\n    const term: ITerm = {\r\n      Name: ts.Name,\r\n      Id: ts.Id,\r\n      TermSet: ts,\r\n      PathOfTerm: \"\",\r\n      _ObjectType_: ts._ObjectType_,\r\n      _ObjectIdentity_: ts._ObjectIdentity_,\r\n      Description: ts.Description,\r\n      IsDeprecated: null,\r\n      IsAvailableForTagging: null,\r\n      IsRoot: null\r\n    };\r\n\r\n    // Trigger the normal change event\r\n    this.termsChanged(term, isChecked);\r\n  }\r\n\r\n  /**\r\n   * Renders the SPListpicker controls with Office UI  Fabric\r\n   */\r\n  public render(): JSX.Element {\r\n\r\n    return (\r\n      <div>\r\n        {this.props.label && <Label>{this.props.label}</Label>}\r\n        <div className={styles.termField}>\r\n          <div className={styles.termFieldInput}>\r\n            <TermPicker\r\n              context={this.props.context}\r\n              termPickerHostProps={this.props}\r\n              disabled={this.props.disabled}\r\n              value={this.state.activeNodes}\r\n              isTermSetSelectable={this.props.isTermSetSelectable}\r\n              onChanged={this.termsFromPickerChanged}\r\n              allowMultipleSelections={this.props.allowMultipleSelections}\r\n              disabledTermIds={this.props.disabledTermIds}\r\n              disableChildrenOfDisabledParents={this.props.disableChildrenOfDisabledParents} />\r\n          </div>\r\n          <div className={styles.termFieldButton}>\r\n            <IconButton disabled={this.props.disabled} iconProps={{ iconName: 'Tag' }} onClick={this.onOpenPanel} />\r\n          </div>\r\n        </div>\r\n\r\n        <FieldErrorMessage errorMessage={this.state.errorMessage} />\r\n\r\n        <Panel\r\n          isOpen={this.state.openPanel}\r\n          hasCloseButton={true}\r\n          onDismiss={this.onClosePanel}\r\n          isLightDismiss={true}\r\n          type={PanelType.medium}\r\n          headerText={this.props.panelTitle}\r\n          onRenderFooterContent={() => {\r\n            return (\r\n              <div className={styles.actions}>\r\n                <PrimaryButton iconProps={{ iconName: 'Save' }} text={strings.SaveButtonLabel} value=\"Save\" onClick={this.onSave} />\r\n                <DefaultButton iconProps={{ iconName: 'Cancel' }} text={strings.CancelButtonLabel} value=\"Cancel\" onClick={this.onClosePanel} />\r\n              </div>\r\n            );\r\n          }}>\r\n\r\n          {\r\n            /* Show spinner in the panel while retrieving terms */\r\n            this.state.loaded === false ? <Spinner type={SpinnerType.normal} /> : ''\r\n          }\r\n          {\r\n            this.state.loaded === true && this.state.termSetAndTerms && (\r\n              <div key={this.state.termSetAndTerms.Id} >\r\n                <h3>{this.state.termSetAndTerms.Name}</h3>\r\n                <TermParent anchorId={this.props.anchorId}\r\n                  autoExpand={null}\r\n                  termset={this.state.termSetAndTerms}\r\n                  isTermSetSelectable={this.props.isTermSetSelectable}\r\n                  termSetSelectedChange={this.termSetSelectedChange}\r\n                  activeNodes={this.state.activeNodes}\r\n                  disabledTermIds={this.props.disabledTermIds}\r\n                  disableChildrenOfDisabledParents={this.props.disableChildrenOfDisabledParents}\r\n                  changedCallback={this.termsChanged}\r\n                  multiSelection={this.props.allowMultipleSelections}\r\n                  spTermService={this.termsService}\r\n\r\n                  updateTaxonomyTree={this.updateTaxonomyTree}\r\n                  termActions={this.props.termActions}\r\n                />\r\n              </div>\r\n            )\r\n          }\r\n        </Panel>\r\n      </div >\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}